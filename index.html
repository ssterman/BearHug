<html>
    <head>
        <script src="http://simplewebrtc.com/latest.js"></script>
          <script type="text/javascript" src="https://cdn.firebase.com/v0/firebase.js"></script>
            <script type='text/javascript' src='https://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js'></script> 
        <link rel="stylesheet" href="index.css" type="text/css"></link>
    </head>
    <body>
    	<div id="localContainer">
        	<video id="localVideo"></video>
        </div>
        <div id="remoteContainer"></div>

        <div id="animationContainer"></div>

        <div id="buttonContainer">
        	<button type="button" onclick="trigger_hug()">Hug!</button>
        	<button type="button" onclick="trigger_pat()">Pat!</button>
        	<button type="button" onclick="trigger_kiss()">Kiss!</button>
        </div>

        <script>
	        var webrtc = new SimpleWebRTC({
			  // the id/element dom element that will hold "our" video
			  localVideoEl: 'localVideo',
			  // the id/element dom element that will hold remote videos
			  remoteVideosEl: 'remoteContainer',
			  // immediately ask for camera access
			  autoRequestMedia: true
			});

			// we have to wait until it's ready
			webrtc.on('readyToCall', function () {
			  // you can name it anything
			  webrtc.joinRoom('cs247');
			});

            //firebase setup            
            fb_instance = new Firebase("https://avatar-gestures.firebaseio.com/");

            function send_trigger(msg) {
                fb_instance.push({m: msg});
            }
            
            fb_instance.on('child_added', function(snapshot){
                console.log(snapshot.val().m);
                fb_instance.remove();
            });

        	function trigger_hug() {
        		walk();
                send_trigger("hug");
        	}

        	function trigger_pat() {
        		walk();
                send_trigger("pat");
        	}

        	function trigger_kiss() {
        		walk();
                send_trigger("kiss");
        	}

        	function walk() {
        		console.log("walking");
        	}
        </script>

    </body>
</html>